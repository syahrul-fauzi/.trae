sequenceDiagram
  participant U as User
  participant F as Frontend
  participant A as Orchestrator
  participant T as Tools
  participant B as BaseHub
  participant R as RenderWorker
  participant M as LLM

  U->>F: Ask SOP / generate doc
  F->>A: WS event
  A->>M: Plan (CALL_KNOWLEDGE)
  M-->>A: Suggest getDocument
  A->>T: getDocument
  T->>B: GraphQL search
  B-->>T: Blocks
  T-->>A: Blocks
  A->>M: Synthesize
  M-->>A: Stream tokens
  A-->>F: Stream UI
  A->>R: Enqueue renderJob
  R-->>A: Job complete {url}
  A-->>F: Show download link
